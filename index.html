<!DOCTYPE html>  
<html lang="bg">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<!-- SEO Описание -->
<meta name="description" content="Безплатен онлайн калкулатор за ресто - изчислете бързо и точно рестото при плащане в BGN и EUR. Перфектен инструмент за търговци, ресторанти и бизнес потребители.">
<meta name="keywords" content="калкулатор за ресто, ресто калкулатор, изчисли ресто, BGN EUR, плащане, валутен калкулатор, български лева, евро">
<meta name="author" content="BestAuto.bg">

<!-- Favicon -->
<link rel="icon" href="http://calculator.bestauto.bg/logo.png" type="image/png">
<link rel="shortcut icon" href="http://calculator.bestauto.bg/logo.png" type="image/png">

<title>Калкулатор за ресто BestAuto.bg | Изчисляване на ресто в BGN и EUR</title>  
<style>  
:root {  
  --blue1: #0b5fa5;  
  --blue2: #1da1f2;  
  --card-bg: #ffffff;  
  --success-bg: #e8f8f0;  
  --text-dark: #1f2937;  
}  

* {  
  box-sizing: border-box;  
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;  
  touch-action: pan-x pan-y;
}  

body {  
  margin: 0;  
  min-height: 100vh;  
  background: url('https://iili.io/fh0uIpf.jpg') no-repeat center center fixed;
  display: flex;  
  align-items: center;  
  justify-content: center;  
  padding: 16px;  
  -webkit-text-size-adjust: 100%;
}  

.card {
  zoom: 1;
}

input, textarea, select {
  font-size: 16px !important;
}

html {
  -webkit-text-size-adjust: 100%;
  -moz-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

.card {  
  width: 100%;  
  max-width: 420px;  
  background: var(--card-bg);  
  border-radius: 18px;  
  padding: 22px;  
  box-shadow: 0 20px 40px rgba(0,0,0,0.2);  
}  

.logo {  
  display: flex;  
  justify-content: center;  
  margin-bottom: 14px;  
}  

.logo img {  
  max-width: 220px;  
  height: auto;  
}  

h1 {  
  margin: 6px 0 4px;  
  font-size: 22px;  
  text-align: center;  
  color: var(--text-dark);  
}  

.subtitle {  
  text-align: center;  
  font-size: 14px;  
  color: #374151;  
  margin-bottom: 18px;  
}  

.field {  
  margin-bottom: 14px;  
}  

label {  
  display: block;  
  font-size: 14px;  
  margin-bottom: 6px;  
  color: #374151;  
}  

.input-wrap {  
  display: flex;  
  gap: 8px;  
}  

/* ДОБАВЕНО: Стил за контейнер на input с валутен символ */
.input-with-symbol {
  position: relative;
  flex: 1;
}

.input-with-symbol input {
  width: 100%;
  padding: 12px 40px 12px 12px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid #d1d5db;
  box-sizing: border-box;
}

.input-with-symbol .currency-symbol {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 16px;
  font-weight: 600;
  color: #a8aaac;
  pointer-events: none;
}

input:focus {  
  outline: none;  
  border-color: var(--blue2);  
}  

.currency-toggle {  
  display: flex;  
  background: #e5e7eb;  
  border-radius: 10px;  
  overflow: hidden;  
  min-width: 120px;  
}  

.currency-toggle button {  
  border: none;  
  padding: 0 14px;  
  font-size: 14px;  
  cursor: pointer;  
  background: transparent;  
  flex: 1;  
  white-space: nowrap;  
}  

.currency-toggle button.active {  
  background: var(--blue2);  
  color: #fff;  
}  

/* Стил за единичен валутен бутон */
.single-currency-button {
  display: flex;
  background: #e5e7eb;
  border-radius: 10px;
  overflow: hidden;
  min-width: 120px;
}

.single-currency-button button {
  border: none;
  padding: 0 14px;
  font-size: 14px;
  cursor: pointer;
  background: var(--blue2);
  color: #fff;
  flex: 1;
  white-space: nowrap;
  border-radius: 10px;
}

.add-currency-btn {  
  background: #f8f9fa !important;  
  color: #4b5563 !important;  
  border-radius: 10px !important;  
  min-width: 44px;  
  display: flex;  
  align-items: center;  
  justify-content: center;  
  font-size: 20px !important;  
  font-weight: normal;  
  border: 1px solid #d1d5db !important;  
  margin-right: 8px;  
  cursor: pointer !important;  
}  

.add-currency-btn.active {  
  background: var(--blue2) !important;  
  color: #fff !important;  
  border-color: var(--blue2) !important;  
}  

.add-currency-btn:hover {  
  background: #e5e7eb !important;  
}  

.add-currency-btn.active:hover {  
  background: var(--blue1) !important;  
  border-color: var(--blue1) !important;  
}  

.result {  
  background: var(--success-bg);  
  font-weight: bold;  
  color: #047857;  
}  

.warning {  
  font-size: 13px;  
  color: #b91c1c;  
  margin-top: 6px;  
  display: none;  
}  

.rate {  
  margin-top: 14px;  
  text-align: center;  
  font-size: 13px;  
  color: #6b7280;  
}  

.footer {  
  margin-top: 16px;  
  text-align: center;  
  font-size: 12px;  
  color: #6b7280;  
  line-height: 1.5;  
}  

.footer a {  
  color: #2563eb;  
  text-decoration: none;  
  font-weight: 500;  
  cursor: pointer;  
}  

.footer a:hover {  
  text-decoration: underline;  
}  

/* Линия над "Ресто" */  
.divider {  
  border: none;  
  height: 1px;  
  background: linear-gradient(to right, transparent, #d1d5db, transparent);  
  margin: 18px 0;  
}  

/* Анимация за рестото */  
@keyframes popFade {  
  0% {  
    transform: scale(0.95);  
    opacity: 0;  
  }  
  100% {  
    transform: scale(1);  
    opacity: 1;  
  }  
}  

.result.animate {  
  animation: popFade 0.3s ease-out;  
}  

/* Стилове за допълнителното валутно поле */  
.additional-currency-field {  
  margin-top: 12px;  
  padding-top: 12px;  
  border-top: 1px dashed #e5e7eb;  
}  

.additional-currency-field label {  
  color: #374151;  
  font-size: 14px;  
}  

/* Иконка със стрелки */  
.arrows-icon {  
  display: inline-block;  
  font-size: 18px;  
  font-weight: normal;  
  line-height: 1;  
}  

/* Responsive стилове */  
@media (max-width: 480px) {  
  .card {  
    padding: 18px;  
    max-width: 100%;  
  }  
  
  h1 {  
    font-size: 20px;  
  }  
  
  .subtitle {  
    font-size: 13px;  
  }  
  
  .input-wrap {  
    flex-direction: column;  
    gap: 10px;  
  }  
  
  .currency-toggle-container {  
    display: flex;  
    width: 100%;  
    gap: 8px;  
  }  
  
  .currency-toggle {  
    min-width: 0;  
    flex: 1;  
    justify-content: stretch;  
  }  
  
  .currency-toggle button {  
    padding: 12px 0;  
    font-size: 14px;  
  }  
  
  .single-currency-button {
    min-width: 0;
    flex: 1;
  }
  
  .single-currency-button button {
    padding: 12px 0;
    font-size: 14px;
    width: 100%;
  }
  
  .add-currency-btn {  
    min-width: 50px;  
    padding: 12px !important;  
    margin-right: 0;  
  }  
  
  input {  
    font-size: 16px;  
    padding: 12px;  
  }  
  
  .field {  
    margin-bottom: 16px;  
  }  
  
  .footer {  
    font-size: 12px;  
  }  
}  

@media (max-width: 360px) {  
  .card {  
    padding: 14px;  
  }  
  
  h1 {  
    font-size: 18px;  
  }  
  
  .currency-toggle button {  
    font-size: 13px;  
    padding: 10px 0;  
  }  
  
  .single-currency-button button {
    font-size: 13px;
    padding: 10px 0;
  }
  
  .add-currency-btn {  
    min-width: 44px;  
    padding: 10px !important;  
  }  
}  

/* Адаптивен дизайн за таблети */  
@media (min-width: 481px) and (max-width: 768px) {  
  .card {  
    max-width: 440px;  
  }  
}  

/* Контейнер за валутни бутони и иконка */  
.currency-toggle-container {  
  display: flex;  
  gap: 8px;  
}  

/* Подравняване на иконката */  
.icon-btn-wrapper {  
  display: flex;  
  gap: 8px;  
}  

/* Курсор pointer за всички бутони */  
button {  
  cursor: pointer;  
}  
</style>  
</head>  
<body>  
<div class="card">  
  <div class="logo">  
    <img src="logo.png" alt="Logo на BestAuto.bg">  
  </div>  

  <h1>Калкулатор за ресто</h1>  
  <div class="subtitle">Изчисли рестото на клиента</div>  

  <div class="field">  
    <label>Цена на продукта</label>  
    <div class="input-wrap">  
      <div class="input-with-symbol">
        <input type="number" id="price" min="0" step="0.01" placeholder="0.00">
        <span class="currency-symbol" id="priceSymbol">€</span>
      </div>
      <div class="currency-toggle-container">
        <div class="single-currency-button">  
          <button>EUR</button>  
        </div>
      </div>
    </div>  
  </div>  

  <div class="field">  
    <label>Платена сума</label>  
    <div class="input-wrap">  
      <div class="input-with-symbol">
        <input type="number" id="paid" min="0" step="0.01" placeholder="0.00">
        <span class="currency-symbol" id="paidSymbol">лв.</span>
      </div>
      <div class="currency-toggle-container">
        <button class="add-currency-btn" id="addCurrencyBtn" title="Добави плащане в друга валута">  
          <span class="arrows-icon">⇄</span>  
        </button>  
        <div class="currency-toggle">  
          <button class="active" data-target="paid" data-currency="BGN">BGN</button>  
          <button data-target="paid" data-currency="EUR">EUR</button>  
        </div>
      </div>
    </div>  
    <!-- Допълнително валутно поле -->  
    <div class="additional-currency-field" id="additionalCurrencyField" style="display: none;">  
      <label>Платена сума в друга валута</label>  
      <div class="input-wrap">  
        <div class="input-with-symbol">
          <input type="number" id="paidAdditional" min="0" step="0.01" placeholder="0.00">
          <span class="currency-symbol" id="paidAdditionalSymbol">€</span>
        </div>
        <div class="currency-toggle-container">
          <div class="currency-toggle">  
            <button data-target="paidAdditional" data-currency="BGN">BGN</button>  
            <button class="active" data-target="paidAdditional" data-currency="EUR">EUR</button>  
          </div>
        </div>
      </div>  
    </div>  
  </div>  

  <!-- линия над Ресто -->  
  <hr class="divider">  

  <div class="field">  
    <label>Ресто</label>  
    <div class="input-wrap">  
      <div class="input-with-symbol">
        <input class="result" id="change" readonly value="0.00">
        <span class="currency-symbol" id="changeSymbol">€</span>
      </div>
      <div class="currency-toggle-container">
        <!-- Променено: EUR първи, след това BGN -->
        <div class="currency-toggle">  
          <button class="active" data-result="EUR">EUR</button>  
          <button data-result="BGN">BGN</button>  
        </div>
      </div>
    </div>  
    <div class="warning" id="warning">Недостатъчна сума</div>  
  </div>  

  <div class="rate">Курс: 1 EUR = 1.95583 BGN</div>  

<div class="footer">
  Разработен от 
  <a href="https://www.linkedin.com/in/tsvetelinpenkov" target="_blank" rel="noopener">
    Цветелин Пенков
  </a>
</div> 

<script>  
const RATE = 1.95583;  

let priceCurrency = 'EUR';
let paidCurrency = 'BGN';  
let paidAdditionalCurrency = 'EUR';
let resultCurrency = 'EUR';
let additionalCurrencyVisible = false;  

function convert(value, from, to) {  
  if (from === to) return value;  
  if (from === 'EUR') return value * RATE;  
  return value / RATE;  
}  

// Функция за обновяване на валутните символи
function updateCurrencySymbols() {
  // Символ за цена на продукта (винаги EUR)
  document.getElementById('priceSymbol').textContent = '€';
  
  // Символ за платена сума
  document.getElementById('paidSymbol').textContent = paidCurrency === 'BGN' ? 'лв.' : '€';
  
  // Символ за допълнителна платена сума
  document.getElementById('paidAdditionalSymbol').textContent = paidAdditionalCurrency === 'BGN' ? 'лв.' : '€';
  
  // Символ за ресто
  document.getElementById('changeSymbol').textContent = resultCurrency === 'BGN' ? 'лв.' : '€';
}

function calculate() {  
  const price = parseFloat(priceInput.value) || 0;  
  const paid = parseFloat(paidInput.value) || 0;  
  const paidAdditional = parseFloat(paidAdditionalInput.value) || 0;  

  // Конвертира всичко към BGN  
  const priceBGN = convert(price, priceCurrency, 'BGN');  
  const paidBGN = convert(paid, paidCurrency, 'BGN');  
  
  let totalPaidBGN = paidBGN;  
  
  // Добавя допълнителната сума ако е видимо полето  
  if (additionalCurrencyVisible && paidAdditional > 0) {  
    const paidAdditionalBGN = convert(paidAdditional, paidAdditionalCurrency, 'BGN');  
    totalPaidBGN += paidAdditionalBGN;  
  }  

  if (totalPaidBGN < priceBGN) {  
    warning.style.display = 'block';  
    changeInput.value = '0.00';  
    return;  
  }  

  warning.style.display = 'none';  
  const changeBGN = totalPaidBGN - priceBGN;  
  const final = resultCurrency === 'BGN'  
    ? changeBGN  
    : convert(changeBGN, 'BGN', 'EUR');  

  changeInput.classList.remove('animate');  
  void changeInput.offsetWidth; // reset animation  
  changeInput.value = final.toFixed(2);  
  changeInput.classList.add('animate');  
}  

const priceInput = document.getElementById('price');  
const paidInput = document.getElementById('paid');  
const paidAdditionalInput = document.getElementById('paidAdditional');  
const changeInput = document.getElementById('change');  
const warning = document.getElementById('warning');  
const addCurrencyBtn = document.getElementById('addCurrencyBtn');  
const additionalCurrencyField = document.getElementById('additionalCurrencyField');  

// Бутон за добавяне на допълнително валутно поле  
addCurrencyBtn.addEventListener('click', () => {  
  additionalCurrencyVisible = !additionalCurrencyVisible;  
  if (additionalCurrencyVisible) {  
    additionalCurrencyField.style.display = 'block';  
    addCurrencyBtn.classList.add('active');  
    
    // Автоматично определяне на обратната валута за допълнителното поле  
    const additionalButtons = additionalCurrencyField.querySelectorAll('.currency-toggle button');  
    additionalButtons.forEach(btn => btn.classList.remove('active'));  
    
    if (paidCurrency === 'BGN') {  
      paidAdditionalCurrency = 'EUR';  
      additionalButtons[1].classList.add('active'); // EUR бутон  
    } else {  
      paidAdditionalCurrency = 'BGN';  
      additionalButtons[0].classList.add('active'); // BGN бутон  
    }  
  } else {  
    additionalCurrencyField.style.display = 'none';  
    addCurrencyBtn.classList.remove('active');  
    paidAdditionalInput.value = '';  
  }  
  updateCurrencySymbols();
  calculate();  
});  

// Управление на валутните бутони  
document.querySelectorAll('.currency-toggle button').forEach(btn => {  
  btn.addEventListener('click', function() {  
    const parent = this.parentElement;  
    parent.querySelectorAll('button').forEach(b => {  
      b.classList.remove('active');  
    });  
    this.classList.add('active');  

    if (this.dataset.target === 'paid') {  
      paidCurrency = this.dataset.currency;  
      // Ако допълнителното поле е видимо, обнови валутата там  
      if (additionalCurrencyVisible) {  
        const additionalButtons = additionalCurrencyField.querySelectorAll('.currency-toggle button');  
        additionalButtons.forEach(btn => btn.classList.remove('active'));  
        
        if (paidCurrency === 'BGN') {  
          paidAdditionalCurrency = 'EUR';  
          additionalButtons[1].classList.add('active');  
        } else {  
          paidAdditionalCurrency = 'BGN';  
          additionalButtons[0].classList.add('active');  
        }  
      }  
    }  
    if (this.dataset.target === 'paidAdditional') paidAdditionalCurrency = this.dataset.currency;  
    if (this.dataset.result) resultCurrency = this.dataset.result;  

    updateCurrencySymbols();
    calculate();  
  });  
});  

// Слушатели за входни полета  
priceInput.addEventListener('input', calculate);  
paidInput.addEventListener('input', calculate);  
paidAdditionalInput.addEventListener('input', calculate);  

// Допълнителна JavaScript защита срещу зуум
document.addEventListener('wheel', function(e) {
  if (e.ctrlKey) {
    e.preventDefault();
  }
}, { passive: false });

document.addEventListener('touchstart', function(e) {
  if (e.touches.length > 1) {
    e.preventDefault();
  }
}, { passive: false });

let lastTouchEnd = 0;
document.addEventListener('touchend', function(e) {
  const now = (new Date()).getTime();
  if (now - lastTouchEnd <= 300) {
    e.preventDefault();
  }
  lastTouchEnd = now;
}, { passive: false });

// Инициализация  
document.addEventListener('DOMContentLoaded', () => {  
  // Добавяме placeholder стойности за по-добра UX  
  priceInput.placeholder = '0.00';  
  paidInput.placeholder = '0.00';  
  paidAdditionalInput.placeholder = '0.00';  
  
  // Инициализираме резултата с валута EUR
  const resultButtons = document.querySelector('.currency-toggle[data-result]')?.querySelectorAll('button');
  if (resultButtons) {
    resultButtons.forEach(btn => btn.classList.remove('active'));
    const eurButton = Array.from(resultButtons).find(btn => btn.dataset.result === 'EUR');
    if (eurButton) {
      eurButton.classList.add('active');
    }
  }
  
  // Обновяваме символите при зареждане
  updateCurrencySymbols();
});  
</script>  
</body>  
</html>